source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
clusterFloorPrices(df3) %>% arrange(floor_price) %>% View()
clusterFloorPrices(df3) %>% arrange(floor_price) %>% `[[`(cluster) %>% class()
clusterFloorPrices(df3) %>% arrange(floor_price) %>% `[[`("cluster") %>% class()
clusterFloorPrices(df3) %>% arrange(floor_price) %>% `[[`("cluster") %>% as.factor() %>% as.numeric()
clusterFloorPrices(df3) %>% arrange(floor_price) %>% `[[`("cluster") %>% distinct()
clusterFloorPrices(df3) %>% arrange(floor_price) %>% `[`("cluster") %>% distinct()
?kmeans
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
clusterFloorPrices(df3) %>% arrange(floor_price) %>% `[`("cluster") %>% distinct()
clusterFloorPrices(df3) %>% arrange(floor_price) %>% View()
a <- df3 %>% filter(as.Date(date_joined)>="2015-09-30") %>% group_by(tag_name, network, floor_price) %>% summarise(impressions=sum(impressions), served=sum(served)) %>% ungroup() %>% mutate(fill=served/impressions) %>% left_join(clusterFloorPrices(df3))
View(a)
ggplot(a) + geom_point(aes(x=impressions, y=served, color=cluster))
ggplot(a) + geom_point(aes(x=impressions, y=served, color=as.factor(cluster)))
ggplot(a) + geom_point(aes(x=impressions, y=fill, color=as.factor(cluster)))
ggplot(a %>% filter(impressions>1000)) + geom_point(aes(x=impressions, y=fill, color=as.factor(cluster)))
names(df3)
?substr
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
same_network_ordinal(df2)
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
sameNetworkOrdinal(df2)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df2 %>% preprocess()
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df2 %>% preprocess()
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df2 %>% preprocess()
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df2 %>% preprocess()
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df2 %>% preprocess()
source('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
a <- preprocess2(df3)
View(fp_clusters)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
a <- preprocess2(df3)
df3 <- preprocess(df2)
a <- preprocess2(df3)
View(a)
source('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df3 <- preprocess(df2)
source('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
df3 <- preprocess(df2)
a <- preprocess2(df3)
View(a)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
View(df4)
View(df3)
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
View(df4)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df4 <- plotPhi(df3)
View(df4)
nrow(df4 %>% filter(prev_network_cluster!="NA")
)
df5 <- left_join(df4, df4 %>%filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(network_cluster=prev_network_cluster, prev_fill=fill)
)
df5 <- left_join(df4, df4 %>%filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(prev_network_cluster=network_cluster, prev_fill=fill))
df5 <- df4 %>% filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(prev_network_cluster = network_cluster, prev_fill=fill)
View(df5)
df5 <- df4 %>% filter(ordinal==0) %>% select(-prev_network_cluster)
df5 <- df4 %>% ungroup() %>% filter(ordinal==0) %>% select(-prev_network_cluster)
df5 <- df4 %>% ungroup() %>% filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(prev_network_cluster = network_cluster, prev_fill=fill)
df5 <- left_join(df4,df4 %>% ungroup() %>% filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(prev_network_cluster = network_cluster, prev_fill=fill))
df5 <- left_join(df4,df4 %>% ungroup() %>% filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(prev_network_cluster = network_cluster, prev_fill=fill), by="network_cluster")
df5 <- left_join(df4,df4 %>% ungroup() %>% filter(ordinal==0) %>% select(-prev_network_cluster) %>% rename(prev_network_cluster = network_cluster, prev_fill=fill), by="prev_network_cluster")
df5 <- left_join(df4,df4 %>% ungroup() %>% filter(ordinal==0) %>% select(network_cluster,fill) %>% rename(prev_network_cluster = network_cluster, prev_fill=fill), by="prev_network_cluster")
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
df5 <- preparePhiData(df4)
df5 <- preparePhiData(df3)
View(df5)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(df3)
?geom_smooth
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(df3)
ls()
df43 <- df[df$placement_id==levels(df$placement_id)[43],]
View(df43)
plotPhiData(preoprocess(df43))
plotPhiData(preprocess(df43))
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(preprocess(df43))
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(preprocess(df43))
plotPhiData(df3)
source('C:/Shahar/Projects/Optimization/placement_attributes/modelingTools.R')
plotPhiData(df3)
plotPhiData(preprocess(df43))
?lm
df43p <- df43 %>% preprocess() %>% preprocess2()
lm( fill ~ x+0,df43p, df43p$prev_same_network)
df43p <- df43 %>% preprocess() %>% preprocess2() %>% preparePhiData()
lm( fill ~ x+0,df43p, df43p$prev_same_network)
lm( fill ~ x+0,df43p, !df43p$prev_same_network)
lm( fill ~ x+0,df3, df3$prev_same_network)
df3p <- df3 %>% preparePhiData()
lm( fill ~ x+0,df3p, df3p$prev_same_network)
lm( fill ~ x+0,df3p, !df3p$prev_same_network)
df48 <- df[df$placement_id==levels(df$placement_id)[48],]
df48p <- df48 %>% preprocess() %>% preprocess2() %>% preparePhiData()
plotPhiData(df48p)
df48p <- df48 %>% preprocess() %>% preprocess2()
plotPhiData(df48p)
df13 <- df[df$placement_id==levels(df$placement_id)[13],]
df13p <- df13 %>% preprocess() %>% preprocess2()
plotPhiData(df13p)
df24 <- df[df$placement_id==levels(df$placement_id)[24],]
df24p <- df24 %>% preprocess() %>% preprocess2()
plotPhiData(df24p)
?group_by
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin <- loadDF3()
nrow(myessin)
myessin1 <- preoprocess3(myessin)
myessin1 <- preprocess3(myessin)
myessin1 <- preprocess(myessin)
myessin2 <- myessin1 %>% group_by(placement_id, chain, ordinal, network, floor_price) %>%
summarise(served = sum(served),
impressions = sum(impressions),
income = sum(income)
)
myessin2 <- myessin2 %>%
mutate(ecpm = 1000 * income /served,
rcpm = 1000 * income / impressions,
fill = served / impressions)
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = sum(ifelse(ordinal==0,impressions,0)),
chain_length = max(as.numeric(as.character(ordinal)))+1,
cum_fill = cumsum(served) / chain_impressions,
cum_rcpm = cumsum(rcpm)
)
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = sum(ifelse(as.character(ordinal)=="0",impressions,0)),
chain_length = max(as.numeric(as.character(ordinal)))+1,
cum_fill = cumsum(served) / chain_impressions,
cum_rcpm = cumsum(rcpm)
)
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = sum(ifelse(as.character(ordinal)=="0",impressions,0)),
chain_length = max(as.numeric(as.character(ordinal)))+1)
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_length = max(as.numeric(as.character(ordinal)))+1)
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = sum(ifelse(as.character(ordinal)=="0",impressions,0)))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(as.character(ordinal)=="0",impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(T,impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = as.character(ordinal))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(as.character(ordinal),impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(as.character(ordinal)==0,impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(as.character(ordinal)=="",impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(as.character(ordinal)=="0",impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(as.numeric(as.character(ordinal))==0,impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(ordinal==1,impressions,0))
myessin2 <- myessin2 %>% group_by(placement_id, chain) %>%
mutate(chain_impressions = ifelse(ordinal==0,impressions,0))
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
View(myessin1)
myessin1$ordinal %>% class()
levels(myessin1$ordinal)
as.factor(0)
as.factor("0")
"124" + "45"
"124" + 45
124 + 45
124 + "45"
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
warnings()
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
View(myessin1)
View(myessin)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
View(myessin)
View(myessin1)
?min
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
View(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
myessin1 <- preprocess3(myessin)
View(myessin1)
dfa <- preprocess3(df)
nrow(df)
nrow(df1)
nrow(df2)
dfa <- preprocess3(df2)
View(dfa)
View(df2)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
dfa <- preprocess3(df2)
View(dfa)
source('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
dfa <- preprocess3(df2)
source('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
dfa <- preprocess3(df2)
myessin1 <- preprocess3(myessin)
View(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
?geom_path
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
View(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
?geom_point
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(myessin1)
df2a <- preprocess3(df2)
plotChains(df2a)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(df2a)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(df2a)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(df2a)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
yessin.jan <- loadDF4()
nrow(yessin.jan)
yessin.jan2 <- preprocess3(yessin.jan)
plotChains(yessin.jan2)
plotChains(myessin1)
plotChains(myessin1 %>% filter(placement_id=="c0188b44d260db11269fed53026a794f"))
ebbcc <- read.csv('performance_with_history_mark_yessin_dec.csv')
plotChains(process3(eebbcc))
plotChains(preProcess3(eebbcc))
plotChains(preprocess3(eebbcc))
plotChains(preprocess3(ebbcc))
levels(ebbcc$placement_id)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
ebbcc <- read.csv('performance_with_history_22ebbcc.csv')
levels(ebbcc$placement_id)
plotChains(preprocess3(ebbcc))
min(ebbcc$date_joined)
min(as.Date(ebbcc$date_joined))
max(as.Date(ebbcc$date_joined))
week=floor(as.Date(ebbcc$date_joined)- as.Date("2016-01-05"))
week
week=floor(as.Date(ebbcc$date_joined)- as.Date("2016-01-05")/7)
week=floor(as.numeric(as.Date(ebbcc$date_joined)- as.Date("2016-01-05"))/7)
week
ebbcc1 <- ebbcc
ebbcc1$placement_id <- week
plotChains(preprocess3(ebbcc1))
plotPhiData(ebbcc)
plotPhiData(preprocess(ebbcc))
plotChains(preprocess3(ebbcc1 %>% filter(placement_id==0)))
plotChains(preprocess3(ebbcc1) %>% filter(placement_id==0, chain_length>2)))
plotChains(preprocess3(ebbcc1) %>% filter(placement_id==0, chain_length>2))
ebbcc2 <- preprocess3(ebbcc1)
View(ebbcc2)
ebbcc2 %>% filter(chain="t71=3.15:e28=1.85:j8=1.75:t57=1.65") %>% View()
ebbcc2 %>% filter(chain=="t71=3.15:e28=1.85:j8=1.75:t57=1.65") %>% View()
ebbcc2 %>% filter(chain=="e2=2.6:e18=2.3:e45=1.95:j14=1.95:e37=1.55") %>% View()
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = chain_imps/sum(chain_imps)) %>% View()
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = chain_impressions/sum(chain_impressions)) %>% View()
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = chain_impressions/sum(chain_impressions)) %>% filter(chain=="e2=2.6:e18=2.3:e45=1.95:j14=1.95:e37=1.55") %>% View()
plotChains(preprocess3(ebbcc1) %>% filter(chain=="t71=3.15:e28=1.85:j8=1.75:t57=1.65")
)
plotChains(preprocess3(ebbcc1) %>% filter(chain=="e2=2.6:e18=2.3:e45=1.95:j14=1.95:e37=1.55"))
plotChains(preprocess3(ebbcc1) %>% filter(chain_length>2)
)
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
eebbcc2$highlight = ifelse(chain=="e2=2.6:e18=2.3:e45=1.95:j14=1.95:e37=1.55", 2, 1)
eebbcc2$highlight = ifelse(as.character(eebbcc2$chain)=="e2=2.6:e18=2.3:e45=1.95:j14=1.95:e37=1.55", 2, 1)
ebbcc2$highlight = ifelse(as.character(ebbcc2$chain)=="e2=2.6:e18=2.3:e45=1.95:j14=1.95:e37=1.55", 2, 1)
plotChains(ebbcc2 %>% filter(chain_length>2))
ebbcc2 %>% filter(chain_length>2)
plotChains(ebbcc2 %>% filter(chain_length>2))
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(ebbcc2 %>% filter(chain_length>2))
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(ebbcc2 %>% filter(chain_length>2))
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(ebbcc2 %>% filter(chain_length>2))
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape=as.factor(ordinal)))
ggplot(df) + geom_point(aes(x=cum_fill, y=cum_rcpm, size=chain_impressions, colour=colorCol, shape=as.factor(ordinal)))
ggplot(df) + geom_point(aes(x=cum_fill, y=cum_rcpm, size=chain_impressions, colour=highlight, shape=as.factor(ordinal)))
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(ebbcc2 %>% filter(chain_length>2))
plotChains(ebbcc2 %>% filter(chain_length>2, ordinal==chain_length))
plotChains(ebbcc2 %>% filter(chain_length>2, ordinal==chain_length-1))
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
plotChains(ebbcc2 %>% filter(chain_length>2, ordinal==chain_length-1))
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="ordinal"))
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="ordinal")) + facet_wrap(~placement_id)
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="ordinal"), alpha=0.4) + facet_wrap(~placement_id)
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="ordinal")) + facet_wrap(~placement_id)
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", colour=colorCol, shape="ordinal")) + facet_wrap(~placement_id)
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = chain_impressions/sum(chain_impressions)) %>% View()
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = floor(100*chain_impressions/sum(chain_impressions))) %>% View()
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = floor(10000*chain_impressions/sum(chain_impressions)/100)) %>% View()
ebbcc2 %>% filter(ordinal==0) %>% group_by(placement_id) %>% mutate(rel_imps = floor(10000*chain_impressions/sum(chain_impressions))/100) %>% View()
ebbcc2 %>% filter(ordinal==chain_length) %>% group_by(placement_id) %>% mutate(rel_imps = floor(10000*chain_impressions/sum(chain_impressions))/100) %>% View()
ebbcc2 %>% filter(ordinal==chain_length-1) %>% group_by(placement_id) %>% mutate(rel_imps = floor(10000*chain_impressions/sum(chain_impressions))/100) %>% View()
plotChains(ebbcc2 %>% filter(chain_length>2, ordinal==chain_length-1))
df <- df %>% group_by(placement_id) %>% mutate(rel_imps = floor(10000*chain_impressions/sum(chain_impressions))/100)
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", colour=colorCol, shape="ordinal", size="rel_imps")) + facet_wrap(~placement_id)
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", colour=colorCol, shape="placement_id", size="rel_imps"))
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", colour=colorCol, shape="as.factor(placement_id)", size="rel_imps"))
ggplot(df) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", colour=colorCol, shape="as.factor(placement_id)", size="rel_imps")) + geom_path(aes_string(x="cum_fill", y="cum_rcpm", colour=colorCol,group="chain"))
min(as.Date(eebbcc$date_joined))
min(as.Date(ebbcc$date_joined))
plotPhiData(df2)
plotPhiData(preparePhiData(df2))
nrow(df2)
plotPhiData(preparePhiData(df3))
plotPhiData(preprocess(df2))
source('C:/Shahar/Projects/discrepancy2016/session1.R')
nrow(df)
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07") %>% preprocess3() %>% group_by(placement_id)
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07") %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain))
min(as.Date(df$date_joined))
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07") %>% preprocess3() # %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain))
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07") %>% preprocess3() #
class(df$ordinal)
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07") %>% preprocess() #
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07")
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07") %>% preprocess()
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07") %>% preprocess()
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07") %>% preprocess()
sum(is.na(ordinal))
length(ordinal)
?find
?match
match(is.na(ordinal), T)
sum(is.na(df$ordinal))
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07", !is.na(ordinal)) %>% preprocess()
source('C:/Shahar/Projects/Optimization/placement_attributes/session1.R')
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07", !is.na(ordinal)) %>% preprocess()
tot <- df %>% filter(as.Date(date_joined) <= "2015-09-07", !is.na(ordinal)) %>% preprocess3()
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07") %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain))
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain))
View(tot)
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% arrange(-sum(nchains)) %>% ungroup()
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% arrange(-sum(n_chains)) %>% ungroup()
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% mutate(placement_chains=sum(n_chains)) %>% ungroup() %>% arrange(-placement_chains, placement_id)
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% mutate(impressions=sum(impressions), served=sum(served), placement_chains=sum(n_chains)) %>% ungroup() %>% arrange(-placement_chains, placement_id)
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% mutate(impressions=sum(impressions), served=sum(served), placement_chains=sum(n_chains)) %>% ungroup() %>% arrange(-placement_chains, placement_id) %>% dcast(placement_id ~ n_chains)
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% mutate(impressions=sum(impressions), served=sum(served), placement_chains=sum(n_chains)) %>% ungroup() %>% arrange(-placement_chains, placement_id) %>% dcast(placement_id ~ chain_length, mean)
tot <- df %>% filter(as.Date(date_joined) <= "2015-10-07", !is.na(ordinal)) %>% preprocess3() %>% group_by(placement_id, chain_length) %>% summarise(impressions = sum(chain_impressions), served=sum(served), n_chains=n_distinct(chain)) %>% group_by(placement_id) %>% mutate(impressions=sum(impressions), served=sum(served), placement_chains=sum(n_chains)) %>% ungroup() %>% arrange(-placement_chains, placement_id)
View(tot)
ggplot(tot) + geom_point(aes(x=impressions,y=placement_chains))
tot %>% group_by(chain_length) %>% summarise(n_chains=sum(n_chains))
ggplot(tot) + geom_point(aes(x=log(impressions),y=placement_chains))
ggplot(tot) + geom_point(aes(x=log10(impressions),y=placement_chains))
source('C:/Shahar/Projects/Optimization/placement_attributes/feasible_region.R')
nrow(df)
nrow(df %>% filter(placement_id = "66efa8ef06355f0c70da35c246b2e07d"))
nrow(df %>% filter(placement_id == "66efa8ef06355f0c70da35c246b2e07d"))
df %>% filter(placement_id == "66efa8ef06355f0c70da35c246b2e07d") %>% mutate(day=as.numeric(as.Date(date_joined)-"2015-09-01"), week=floor(day/7)
)
df %>% filter(placement_id == "66efa8ef06355f0c70da35c246b2e07d") %>% mutate(day=as.numeric(as.Date(date_joined)-"2015-09-01")/)
df %>% filter(placement_id == "66efa8ef06355f0c70da35c246b2e07d") %>% mutate(day=as.numeric(as.Date(date_joined)-"2015-09-01"))
df %>% filter(placement_id == "66efa8ef06355f0c70da35c246b2e07d") %>% mutate(day=as.numeric(as.Date(date_joined)-as.Date("2015-09-01")))
df66ef <- df %>% filter(placement_id == "66efa8ef06355f0c70da35c246b2e07d") %>% mutate(day=as.numeric(as.Date(date_joined)-as.Date("2015-09-01")), week = floor(day/7))
vew df66ef
View( df66ef)
source('C:/Shahar/Projects/Optimization/placement_attributes/session5.R')
p66ef <- prepareForBouquet("66efa8ef06355f0c70da35c246b2e07d")
p66ef <- prepareForBouquet(df, "66efa8ef06355f0c70da35c246b2e07d")
View(p66ef)
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
bouquetPlot(p66ef)
pmin("","T")
pmax("","T")
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
bouquetPlot(p66ef)
p66ef %>% preprocess3() %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% View()
bouquetPlot(p66ef)
p66ef %>% preprocess3() %>% View()
bouquetPlot(p66ef %>% filter(placement_id==2, chain=="17=0.35:e23=0.3:e21=0.3:e32=0.25:e29=0.25"))
bouquetPlot(p66ef %>% filter(placement_id==2, chain=="17=0.35:e23=0.3:e21=0.3:e32=0.25:e29=0.25", !is.na(ordinal)))
p66ef %>% filter(placement_id==2, chain=="17=0.35:e23=0.3:e21=0.3:e32=0.25:e29=0.25") %>% preprocess3() %>% View()
p66ef %>% filter(placement_id==2, chain=="17=0.35:e23=0.3:e21=0.3:e32=0.25:e29=0.25") %>%  View()
p66ef %>% filter(placement_id==2, chain=="e17=0.35:e23=0.3:e21=0.3:e32=0.25:e29=0.25") %>%  View()
bouquetPlot(p66ef %>% filter(placement_id==2, chain=="e17=0.35:e23=0.3:e21=0.3:e32=0.25:e29=0.25"))
p66ef %>% preprocess(3) %>% filter(placement_id==5, cum_fill>1) %>%  View()
p66ef %>% preprocess3() %>% filter(placement_id==5, cum_fill>1) %>%  View()
bouquetPlot(p66ef %>% filter(placement_id==5, chain=="o11=0.5:e11=0.45:e12=0.45:e13=0.4")) %>% View()
p66ef %>% filter(placement_id==5, chain=="o11=0.5:e11=0.45:e12=0.45:e13=0.4") %>% View()
p66ef %>% preprocess3() %>% filter(placement_id==5, chain=="o11=0.5:e11=0.45:e12=0.45:e13=0.4") %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% filter(placement_id==5, chain=="o11=0.5:e11=0.45:e12=0.45:e13=0.4") %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% filter(placement_id==5, chain=="o11=0.5:e11=0.45:e12=0.45:e13=0.4") %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% filter(placement_id==5, chain=="o11=0.5:e11=0.45:e12=0.45:e13=0.4") %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
bouquetPlot(p66ef)
p66ef %>% preprocess3() %>% filter(placement_id==0) %>% View()
p66ef %>% filter(placement_id==0, chain=="e30=0.35:p12=0.35:o24=0.35") %>% bouquetPlot()
bouquetPlot(p66ef)
p66ef %>% filter(placement_id==0, chain=="o17=0.85:o18=0.7:o19=0.4:o20=0.35:e27=0.3") %>% bouquetPlot()
bouquetPlot(p66ef)
p66ef %>% filter(placement_id==0, chain=="o17=0.85:o18=0.7:o19=0.4:o20=0.35:e27=0.3") %>% bouquetPlot(colorCol="chain")
p66ef %>% filter(placement_id==0) %>% bouquetPlot(colorCol="chain")
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% filter(placement_id==0) %>% bouquetPlot()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% filter(placement_id==0) %>% View()
p66ef %>% preprocess3() %>% filter(placement_id==0, chain=="o17=0.85:o18=0.7:o19=0.4:o20=0.35:e27=0.3") %>% View()
p66ef %>% preprocess3() %>% filter(placement_id==0) %>% View()
p66ef %>% preprocess3() %>% filter(placement_id==0, chain=="p2=0.4:e2=0.4:o23=0.35:e31=0.25") %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% filter(placement_id==0) %>% bouquetPlot()
p66ef %>% bouquetPlot()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
timeFlowPlot(p66ef)
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
timeFlowPlot(p66ef)
ggplot(df %>% filter(ordinal=chain_length-1)) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="placement_id"))
df$floor_price = as.factor(df$placement_id)
ggplot(df %>% filter(ordinal=chain_length-1)) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="placement_id"))
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
df$placement_id = as.factor(df$placement_id)
ggplot(df %>% filter(ordinal=chain_length-1)) + geom_point(aes_string(x="cum_fill", y="cum_rcpm", size="chain_impressions", colour=colorCol, shape="placement_id"))
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
timeFlowPlot(p66ef)
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
timeFlowPlot(p66ef)
head(df$chain_length)
head(df$placement_id)
head(df$ordinal)
debugSource('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
timeFlowPlot(p66ef)
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
timeFlowPlot(p66ef)
df %>% preprocess3() %>% filter(ordinal==chain_length-1) %>% arrange(chain) %>% View()
p66ef %>% preprocess3() %>% filter(ordinal==chain_length-1) %>% arrange(chain) %>% View()
source('C:/Shahar/Projects/Optimization/placement_attributes/bouquetPlot.R')
p66ef %>% preprocess3() %>% filter(ordinal==chain_length-1) %>% arrange(chain) %>% View()
timeFlowPlot(p66ef)
plotPhiData(p66ef)
plotPhiData(p66ef %>% preprocess())
View(tot)
p6c2 <- df %>% filter(placement_id=="6c2f85cb01a07b96ae1b1522ebd27870")
nrow(p6c2)
bouquetPlot(p6c2)
bouquetPlot(p6c2 %>% preprocess())
sum(is.na(p6c2$ordinal))
View(p6c2)
p6c2 <- df %>% filter(placement_id=="6c2f85cb01a07b96ae1b1522ebd27870", chain!="")
nrow(p6c2)
bouquetPlot(p6c2)
source('C:/Shahar/Projects/Optimization/placement_attributes/session5.R')
p6c2 <- prepareForBouquet(df, "6c2f85cb01a07b96ae1b1522ebd27870")
bouquetPlot(p6c2)
plotPhiData(p6c2)
plotPhiData(p6c2 %>% preprocess())
