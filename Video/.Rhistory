?paste0
source('C:/Shahar/Projects/Video/session1.R')
ggplot(DF)+geom_density(aes(x=ad_start_time,fill=ua_browser)) + facet(~placement_id)
source('C:/Shahar/Projects/Video/session1.R')
View(DF)
source('C:/Shahar/Projects/Video/session1.R')
View(DF)
ggplot(DF)+geom_density(aes(x=ad_start_time,y=..scaled..,fill=ua_browser))
ggplot(DF)+geom_density(aes(x=ad_start_time,y=..scaled..,fill=ua_browser), alpha=0.5) + facet_wrap(~placement_id)
ggplot(DF)+geom_density(aes(x=ad_start_time,y=..scaled..,fill=ua_browser), alpha=0.2) + facet_wrap(~placement_id)
ggplot(DF)+geom_density(aes(x=ad_start_time,y=..scaled..,fill=ua_browser), alpha=0.9) + facet_wrap(~placement_id)
source('C:/Shahar/Projects/Video/session1.R')
ggplot(DF)+geom_density(aes(x=ad_start_time-tag_start_time,fill=ua_browser), alpha=0.5) + facet_wrap(~placement_id)
source('C:/Shahar/Projects/Video/session1.R')
df <- try2()
summary(df$tvadStart)
ggplot2(df)+geom_density(aes(x=tvadStart))
library(ggplot)
library(ggplot2)
ggplot(df)+geom_density(aes(x=tvadStart))
ggplot(df)+geom_density(aes(x=lastHb,fill=is.na(tvadStart)))
ggplot(df)+geom_density(aes(x=lastHb,fill=is.na(tvadStart)), alpha=0/5)
ggplot(df)+geom_density(aes(x=lastHb,fill=is.na(tvadStart)), alpha=0.5)
ggplot(df)+geom_histogram(aes(x=lastHb,y=cumsum(..count..),fill=is.na(tvadStart)), alpha=0/5)
ggplot(df)+geom_histogram(aes(x=lastHb,y=cumsum(..count..),fill=is.na(tvadStart)), alpha=0.5)
ggplot(df)+geom_histogram(aes(x=lastHb,y=cumsum(..count..),fill=is.na(tvadStart)), alpha=0.5, binwidth=10000)
ggplot(df)+geom_histogram(aes(x=lastHb,y=cumsum(..count..),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000)
ggplot(df)+geom_histogram(aes(x=lastHb,y=cumsum(..count..),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
ggplot(df)+geom_histogram(aes(x=lastHb,y=percent_rank(),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
??rank
ggplot(df)+geom_histogram(aes(x=lastHb,y=percent_rank(..count..),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
library(dplyr)
ggplot(df)+geom_histogram(aes(x=lastHb,y=percent_rank(..count..),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
percent_rank()
ggplot(df)+geom_histogram(aes(x=lastHb,y=percent_rank(count),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
ggplot(df)+geom_histogram(aes(x=lastHb,y=percent_rank(),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
ggplot(df)+geom_histogram(aes(x=lastHb,y=percent_rank(lastHb),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
ggplot(df)+geom_path(aes(x=lastHb,y=percent_rank(lastHb),fill=is.na(tvadStart)), alpha=0.5, binwidth=2000) + coord_cartesian(xlim=c(0,60000))
source('C:/Shahar/Projects/Video/session1.R')
df <- try2()
ggplot(df)+geom_density(aes(x=lastHb,fill=is.na(tvadStart)), alpha=0.5)
ggplot(df)+geom_density(aes(x=lastHb,fill=!is.na(tvadStart)), alpha=0.5)
ggplot(df)+geom_density(aes(x=lastHb,fill=!is.na(tvadStart)), alpha=0.5)+xlim(0,1e5)
ggplot(df)+geom_density(aes(x=tvadStart,fill=!is.na(tvadStart)), alpha=0.5)+xlim(0,1e5)
?find
?substr
?grepl
charmatch("C","abcdeFC")
regexpr("C","abcdeFC")
regexpr("C","abcdeFC", fixed=T)
ggplot(df)+geom_density(aes(x=tvadStart,fill=regexpr("C",chain,fixed=T)), alpha=0.5)+xlim(0,1e5)
ggplot(df)+geom_density(aes(x=tvadStart,fill=as.factor(regexpr("C",chain,fixed=T))), alpha=0.5)+xlim(0,1e5)
source('C:/Shahar/Projects/Video/session1.R')
df <- try2()
source('C:/Shahar/Projects/Video/session1.R')
df <- try2()
source('C:/Shahar/Projects/Video/session1.R')
df <- try2()
DF$v_in_string = regexpr("C|F",DF$chain)
DF$v_in_string = regexpr("C",DF$chain)
df$v_in_string = regexpr("C",df$chain)
df$v_in_string = regexpr("C|F",df$chain)
head(df %>% select(chain,v_in_string))
head(df %>% select(chain,v_in_string),200)
df$v_in_string = regexpr("C|f",df$chain)
head(df %>% select(chain,v_in_string),200)
source('C:/Shahar/Projects/Video/session1.R')
try2()
source('C:/Shahar/Projects/Video/session1.R')
df$v_in_string = regexpr("C|f",df$chain)
df %>% group_by(served_tag_network,!is.na(tvadStart),v_in_string) %>% summarise(cnt=n())
a <- df %>% group_by(served_tag_network,!is.na(tvadStart),v_in_string) %>% summarise(cnt=n())
a
print(a)
DF %>% group_by(served_tag_network,!is.na(tvadStart),v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(DF))
df %>% group_by(served_tag_network,!is.na(tvadStart),v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(df))
df %>% group_by(served_tag_network,!is.na(tvadStart),v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(df)) %>% ungroup()
print(df %>% group_by(served_tag_network,!is.na(tvadStart),v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(df)) %>% ungroup())
View(a)
print(df %>% group_by(!is.na(tvadStart),served_tag_network,v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(df)) %>% ungroup())
a <- print(df %>% group_by(!is.na(tvadStart),served_tag_network,v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(df)) %>% ungroup())
a <- print(df %>% group_by(!is.na(tvadStart),served_tag_network,v_in_string) %>% summarise(cnt=n(),pct=n()/nrow(df)) %>% ungroup()) %>% filter(cnt>1000)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeTimeDiffs(df)
summary(df$ts2sResponse - df$ts2sCall)
summary(df$videoLoaded - df$ts2sResponse)
summary(df$tvastResponse - df$videoLoaded)
summary(df$tvpaidloaded - df$tvastResponse)
summary(df$tvadStart - df$tvpaidloaded)
source('C:/Shahar/Projects/Video/session1.R')
Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's
-107400     259     688    1779    1671  167400   27016
source('C:/Shahar/Projects/Video/session1.R')
df <- analyzeTimeDiffs(df)
cor(df[c("diff1","diff2","diff3","diff4","diff5")], use="pairwise.complete.obs")
source('C:/Shahar/Projects/Video/session1.R')
df <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df <- analyzeTimeDiffs(df)
View(df)
df <- loadDF2()
source('C:/Shahar/Projects/Video/session1.R')
df2 <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df2 <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df2 <- analyzeTimeDiffs(df)
ggplot(df2)+geom_density(aes(x=diff4/1000))
ggplot(df2)+geom_density(aes(x=diff4/1000))+xlim(0,30)
view(df2)
View(df2)
names(df)
source('C:/Shahar/Projects/Video/session1.R')
df2 <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df2 <- analyzeTimeDiffs(df)
source('C:/Shahar/Projects/Video/session1.R')
df2 <- analyzeTimeDiffs(df)
View(df2)
ggplot(df2)+geom_point(aes(x=diff4,y=diff5))
ggplot(df2)+geom_point(aes(x=diff4/1000,y=diff5/100)) + xlim(0,30)
ggplot(df2)+geom_point(aes(x=diff4/1000,y=diff5/1000)) + xlim(0,30)
source('C:/Shahar/Projects/Video/session1.R')
na &t
NA & T
source('C:/Shahar/Projects/Video/session1.R')
install.packages(rpart)
install.packages(tree)
install.packages("rpart")
df$isresponse <- ifelse(is.na(df$s2sCall),NA,!is.na(df$s2sResponse))
fit <- rpart(isresponse ~ geo_continent + ua_browser + ua_borwser_os, method="class", data=df)
library(rpart)
fit <- rpart(isresponse ~ geo_continent + ua_browser + ua_borwser_os, method="class", data=df)
fit <- rpart(isresponse ~ geo_continent + ua_browser, method="class", data=df)
fit <- rpart(isresponse ~ geo_continent + ua_browser + ua_browser_os, method="class", data=df)
printcp(fit)
summary(fit)
plot(fit,uniform = T)
?rpart
fit <- rpart(isresponse ~ geo_continent + ua_browser + ua_browser_os, method="class", data=df, control=list(cp=0.0001))
summary(fit)
plot(fit)
plot(fit, uniform=TRUE,
main="Classification Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8)
fit <- rpart(isresponse ~ geo_continent + ua_browser + ua_browser_os, method="class", data=df, control=list(cp=0.001))
plot(fit, uniform=TRUE,
main="Classification Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8)
plot(fit, uniform=TRUE,
main="Classification Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8, minlength =3)
2.603e4+1.186e5
2.603e4/144630
plot(fit, uniform=TRUE,
main="Classification Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8, minlength =3, fancy=T)
plot(fit, uniform=TRUE,
main="Classification Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8, minlength =3)
1.385e4+3.042e4
13850/44270
7636/(7636+1.32e4)
summary(fit)
unique(df$ua_browser_os)
unique(df$geo_continent)
unique(df$ua_browser)
fit <- rpart(isresponse ~ geo_continent + ua_browser_ver + ua_browser_os, method="class", data=df %>% filter(ua_browser="Internet Explorer"), control=list(cp=0.001))
fit <- rpart(isresponse ~ geo_continent + ua_browser_ver + ua_browser_os, method="class", data=df %>% filter(ua_browser=="Internet Explorer"), control=list(cp=0.001))
summary(fit)
unique(df %>% filter(ua_browser="Internet Explorer") %>% select(ua_browser_ver))
unique(df %>% filter(ua_browser=="Internet Explorer") %>% select(ua_browser_ver))
unique(df %>% filter(ua_browser=="Internet Explorer") $ua_browser_ver)
unique(df %>% filter(ua_browser=="Internet Explorer")$ua_browser_ver)
unique(df %>% filter(ua_browser=="Internet Explorer")["ua_browser_ver"])
unique(filter(df,ua_browser=="Internet Explorer")["ua_browser_ver"])
?regexp
gsub("\..*","",filter(df,ua_browser=="Internet Explorer")["ua_browser_ver"])
gsub("\\..*","",filter(df,ua_browser=="Internet Explorer")["ua_browser_ver"])
gsub("\\..*","",filter(df,ua_browser=="Internet Explorer")["ua_browser_ver"],perl=TRUE)
gsub("\\.\\d+","",filter(df,ua_browser=="Internet Explorer")["ua_browser_ver"],perl=TRUE)
unique(filter(df,ua_browser=="Internet Explorer")["ua_browser_ver"])
plot(fit, uniform=TRUE,
main="Classification Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8, minlength =3)
ggplot(DF) +
geom_density(
aes(x=tvadStart,
fill=as.factor(v_in_string),
alpha=0.5)) +
xlim(0,1e5)
ggplot(df) + geom_density(aes(x=tvadStart), alpha=0.5) + xlim(0,1e5)
source('C:/Shahar/Projects/Video/session1.R')
max(na,10)
max(NA,10)
max(NA,10, na.rm=T)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
df1 <- analyzeServeAndDiscrepancy(df)
summary(df1$resp1)
summary(df1$s2s)
summary(!is.na(df$s2sCall))
summary(df1$resp2)
summary(df1$resp1 & !df1$resp2)
summary(df1$resp1 & !df1$resp2 & !df1$resp3)
summary(df1$resp1 & !df1$resp2 & !df1$resp3 & !df1$resp4)
source('C:/Shahar/Projects/Video/session1.R')
df1 <- analyzeServeAndDiscrepancy(df)
source('C:/Shahar/Projects/Video/session1.R')
df1 <- analyzeServeAndDiscrepancy(df)
?geom_bar
