source('C:/Shahar/Projects/sandbox/churn/session1.R')
df <- loadDF()
df <- preprocess(df)
source('C:/Shahar/Projects/sandbox/churn/session1.R')
df <- preprocess(df)
df <- df %>% group_by(site) %>% mutate(high_cost = sum(cost)>1000)
source('C:/Shahar/Projects/sandbox/churn/session1.R')
sum(df$high_cost)
View(df)
df1 <- df %>% filter(high_cost)
unique(df1$site)
length(unique(df1$site))
ggplot(df1) + geom_path(aes(x=month, y=scaled_imps, group=site))
df1$month <- as.numeric(df1$month)
View(df)
ggplot(df1) + geom_path(aes(x=month, y=scaled_imps, group=site))
df1 <- df1 %>% group_by(site) %>% mutate(duration=-min(month))
View(df1)
df2 <- df1 %>% filter(duration <=6)
nrow(df2)
ggplot(df2) + geom_path(aes(x=month, y=scaled_imps, group=site))
as.Date("2015-08-02") > as.Date("2015-09-01")
as.Date("2015-08-02") < as.Date("2015-09-01")
df2 <- df1 %>% filter(duration <=6, last_month < as.Date("2015-11-01"))
nrow(df2)
ggplot(df2) + geom_path(aes(x=month, y=scaled_imps, group=site))
df3 <- df1 %>% filter(duration <=6, last_month = as.Date("2016-01-01"))
df3 <- df1 %>% filter(duration <=6, last_month == as.Date("2016-01-01"))
ggplot(df3) + geom_path(aes(x=month, y=scaled_imps, group=site))
source('C:/Shahar/Projects/sandbox/churn/session1.R')
df <- preprocess(df)
View(df)
ggplot(df %>% filter(duration <=10)) + geom_path(aes(x = month, y = scaled_imps, group = site, color=churn))
df$month = as.numeric(df$month)
ggplot(df %>% filter(duration <=10)) + geom_path(aes(x = month, y = scaled_imps, group = site, color=churn))
dfa <- df %>% filter(duration <=10)) %>% group_by(site, month, churn) %>% summarise(scaled_imps=mean(sacaled_imps))
dfa <- df %>% filter(duration <= 10) %>% group_by(site, month, churn) %>% summarise(scaled_imps=mean(sacaled_imps))
dfa <- df %>% filter(duration <= 10) %>% group_by(site, month, churn) %>% summarise(scaled_imps=mean(scaled_imps))
ggplot(dfa) + geom_path(aes(x = month, y = scaled_imps, group = site, color=churn))
View(df1)
View(dfa)
dfa <- df %>% filter(duration <= 10) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps))
ggplot(dfa) + geom_path(aes(x = month, y = scaled_imps, group = site, color=churn))
ggplot(dfa) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
dfa <- df %>% filter(duration <= 6) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps))
ggplot(dfa) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
View(dfa)
dfa <- df %>% filter(duration <= 6) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps, na.rm=T))
ggplot(dfa) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
ggplot(dfa %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
dfa08 <- df %>% filter(duration <= 8) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps, na.rm=T))
ggplot(dfa08 %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
dfa10 <- df %>% filter(duration <= 10) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps, na.rm=T))
ggplot(dfa10 %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
dfa18 <- df %>% filter(duration <= 18) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps, na.rm=T))
ggplot(dfa18 %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
source('C:/Shahar/Projects/sandbox/churn/session1.R')
df %>% distinct(site) %>% group_by(churn) %>% summarise(n())
df %>% filter(duration <=18) %>% distinct(site) %>% group_by(churn) %>% filter(sum(cost)>1000) %>% summarise(n())
dfa18 <- df %>% filter(duration <= 18, duration>=6) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps, na.rm=T))
source('C:/Shahar/Projects/sandbox/churn/session1.R')
dfa18 <- df %>% filter(duration <= 18, duration>=6) %>% group_by(month, churn) %>% summarise(scaled_imps=mean(scaled_imps, na.rm=T))
ggplot(dfa18 %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=churn))
ggplot(dfa18 %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=!churn))
ggplot(dfa18 %>% filter(!is.na(churn))) + geom_path(aes(x = month, y = scaled_imps, group = churn, color=!churn),size=2)
source('C:/Shahar/Projects/sandbox/churn/session1.R')
