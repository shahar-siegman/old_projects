a <- read.csv('focus_clients_investigate_requested_revshare')
a <- read.csv('focus_clients_investigate_requested_revshare.csv')
nrow(a)
b <- a %>% filter(actual_margin >0.0)
library(dplyr)
b <- a %>% filter(actual_margin >0.0)
nrow(b)
names(b)
d <- b %>% group_by(layoutid) %>% mutate(prev_adj_revshare=lag(new_adj_revshare))
e <- d %>% ungroup()
e <- d %>% ungroup() %>% transmute(actual_margin_gap = requested_revshare-actual_margin, correction_step = new_adj_revshare -prev_adj_revshare)
library(ggplot2)
ggplot(e) + geom_point(aes(x=actual_margin_gap,y=correction_step))
e %>% mutate(fix_ratio = correction_step/actual_margin_gap)
f <- e %>% mutate(fix_ratio = correction_step/actual_margin_gap) %>% filter(!is.na(fix_ratio))
ggplot(f) + geom_histogram(aes(x=fix_ratio))
ggplot(f) + geom_histogram(aes(x=fix_ratio),binwidth=0.06)
ggplot(f) + geom_histogram(aes(x=fix_ratio),binwidth=0.06) + xlim(c(-1,1))
ggplot(f) + geom_histogram(aes(x=fix_ratio),binwidth=0.06) + xlim(c(-0.5,0.5))
